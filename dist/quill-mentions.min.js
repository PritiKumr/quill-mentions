!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){var b=e({},g,a);return a.ajax&&(b.ajax=e({},h,a.ajax)),b}var e=a("../utilities/extend"),f=a("../utilities/identity"),g={ajax:!1,choiceMax:10,choices:[],choiceTemplate:"<li>{{choice}}</li>",hideMargin:"-10000px",matcher:/@\w+$/i,mentionClass:"mention-item",offset:10,template:"<ul>{{choices}}</ul>"},h={format:f,path:null,queryParameter:"q"};b.exports=d},{"../utilities/extend":7,"../utilities/identity":8}],2:[function(a,b,c){function d(a){a.prototype.addFormat=function(a){this.quill.addFormat("mention",{tag:"SPAN","class":"ql-"})}}b.exports=d},{}],3:[function(a,b,c){(function(b){b.QuillMentions=a("./mentions")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./mentions":4}],4:[function(a,b,c){function d(a,b){this.options=h(b),this.quill=a,this.addFormat(),this.currentChoices=null,this.currentMention=null,this.container=this.quill.addContainer("ql-mentions"),this.hide(),this.addListeners()}var e=a("./format"),f=a("./search"),g=a("./view"),h=a("./defaults/defaults");e(d),f(d),g(d),d.prototype.addListeners=function(){var a=this.textChangeHandler.bind(this),b=(this.selectionChangeHandler.bind(this),this.addMentionHandler.bind(this));this.quill.on(this.quill.constructor.events.TEXT_CHANGE,a),this.container.addEventListener("click",b,!1),this.container.addEventListener("touchend",b,!1)},d.prototype.textChangeHandler=function(a){var b,c,d=this.findMention();d?(this.currentMention=d,b=d[0].replace("@",""),c=this,this.search(b,function(a){c.currentChoices=a.slice(0,c.options.choiceMax),c.renderCurrentChoices(),c.show()})):this.container.style.left!==this.options.hideMargin&&(this.currentMention=null,this.range=null,this.hide())},d.prototype.selectionChangeHandler=function(a){throw new Error("No idea what to do with a selection-change event")},d.prototype.findMention=function(){var a,b;return this.range=this.quill.getSelection(),this.range?(a=this.quill.getText(0,this.range.end),b=this.options.matcher.exec(a)):void 0},d.prototype.renderCurrentChoices=function(){if(this.currentChoices&&this.currentChoices.length){var a=this.currentChoices.map(function(a){return this.options.choiceTemplate.replace("{{choice}}",a.name).replace("{{data}}",a.data)},this).join("");this.container.innerHTML=this.options.template.replace("{{choices}}",a)}else this.container.innerHTML=this.options.template.replace("{{choices}}","<li><i>Womp womp...</i></li>")},d.prototype.addMentionHandler=function(a){console.log("Current selection when a choice is clicked: ",this.range);var b=a.target||a.srcElement,c=this.currentMention.index,d="@"+b.innerText,e=c+d.length+1;this.quill.deleteText(c,c+this.currentMention[0].length),this.quill.insertText(c,d,"mention",this.options.mentionClass),this.quill.insertText(c+d.length," "),this.quill.setSelection(e,e),this.hide(),a.stopPropagation()},b.exports=d},{"./defaults/defaults":1,"./format":2,"./search":5,"./view":9}],5:[function(a,b,c){function d(a,b){var c=this.options.ajax?this.ajaxSearch:this.staticSearch;c.call(this,a,b)}function e(a){return-1!==a.name.toLowerCase().indexOf(qry.toLowerCase())}function f(a,b){return function(c){a?a(c.map(b)):h("ajaxSearch")}}function g(a){console.log("Loading json errored...",a)}function h(a){console.log("Warning!",a,"was not provided a callback. Don't be a ding-dong.")}var i=a("./utilities/ajax").loadJSON;b.exports=function(a){a.prototype.search=d,a.prototype.staticSearch=function(a,b){var c=this.options.choices.filter(e);b||h("staticSearch"),b(c)},a.prototype.ajaxSearch=function b(a,c){b.latest&&b.latest.abort();var d=this.options.ajax.path,e=this.options.ajax.format,h=this.options.ajax.queryParameter,j=d+"?"+h+"="+encodeURIComponent(a);b.latest=i(j,f(c,e),g)}}},{"./utilities/ajax":6}],6:[function(a,b,c){b.exports={loadJSON:function(a,b,c){var d=new XMLHttpRequest;return d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&(200===d.status?b&&b(JSON.parse(d.responseText)):c&&c(d))},d.open("GET",a,!0),d.send(),d}}},{}],7:[function(a,b,c){function d(a){for(var b=[].slice.call(arguments,0),c=b[0],d=1;d<b.length;d++)c=e(c,b[d]);return c}function e(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}b.exports=d},{}],8:[function(a,b,c){b.exports=function(a){return a}},{}],9:[function(a,b,c){b.exports=function(a){a.prototype.position=function(a){var b,c,d,e,f,g,h;return a?(b=a.getBoundingClientRect(),c=this.quill.container.getBoundingClientRect(),d=b.left-c.left,e=b.top-c.top,f=b.bottom-c.bottom,g=d+b.width/2-this.container.offsetWidth/2,h=e+b.height+this.options.offset,h+this.container.offsetHeight>this.quill.container.offsetHeight&&(h=e-this.container.offsetHeight-this.options.offset),g=Math.max(0,Math.min(g,this.quill.container.offsetWidth-this.container.offsetWidth)),h=Math.max(0,Math.min(h,this.quill.container.offsetHeight-this.container.offsetHeight))):(g=this.quill.container.offsetWidth/2-this.container.offsetWidth/2,h=this.quill.container.offsetHeight/2-this.container.offsetHeight/2),[g,h]},a.prototype.hide=function(){this.container.style.left=this.options.hideMargin,this.range&&this.quill.setSelection(this.range),this.range=null},a.prototype.show=function(a){this.range=this.quill.getSelection(),a=a||this._findMentionNode(this.range),console.log(a);var b,c,d;b=this.position(a),c=b[0],d=b[1],this.container.style.left=c+"px",this.container.style.top=d+"px",this.container.focus()},a.prototype._findMentionNode=function(a){var b,c,d,e;for(b=this.quill.editor.doc.findLeafAt(a.start,!0),console.log("leafAndOffset",b),c=b[0],d=b[1],c&&(e=c.node);e;){if(console.log("Finding mention node. Looping up...",e),"DIV"===e.tagName)return e;e=e.parentNode}return null}}},{}]},{},[1,2,3,4,5,6,7,8,9]);